# 🏇 競馬オッズ計算機

今日のレース情報を**完全に自動で取得**し、選択した馬券の払戻金を計算できるWebアプリケーションです。手動でのオッズ入力やURLの指定は不要です。

## 🌟 機能

### 対応している馬券種類
- **単勝**: 1着になる馬を当てる
- **複勝**: 3着以内に入る馬を当てる
- **馬連**: 1・2着に入る2頭を当てる（順不同）
- **馬単**: 1・2着を着順通りに当てる
- **ワイド**: 3着以内に入る2頭を当てる（順不同）
- **三連複**: 1・2・3着に入る3頭を当てる（順不同）
- **三連単**: 1・2・3着を着順通りに当てる

### 主な機能
- ✅ **今日のレース情報を自動取得し、一覧表示**（ページ読み込み時に自動実行）
- ✅ レース番号とレース名を併記した、選択しやすいボタン形式のレース一覧
- ✅ 選択したレースの単勝オッズを自動取得・表示
- ✅ レース情報がない場合はボタンを無効化（グレーアウト）して表示
- ✅ 馬券種類選択（ボタン形式）
- ✅ 購入金額の設定（100円単位）
- ✅ 的中馬番の選択
- ✅ 払戻金の自動計算
- ✅ 損益と回収率の表示
- ✅ モダンでレスポンシブなデザイン（スマホ対応）

## 🚀 使い方

このアプリケーションは完全に自動化されており、特別な設定や入力なしにすぐに利用できます。

1.  **ページ読み込み:** アプリケーションにアクセスすると、自動的にその日のレース情報がインターネット（netkeiba.com）から取得されます。
    -   情報取得中は「今日のレース情報を取得中...」と表示されます。
    -   レース情報が見つからない場合は「本日のレースはありません」と表示され、ボタンが選択できなくなります。
2.  **レース選択:** 表示されたレース一覧の中から、計算したいレースのボタンをクリックして選択します。
3.  **馬券種類選択:** 取得されたオッズの下に表示される馬券種類（単勝、複勝など）のボタンをクリックして選択します。
4.  **購入金額設定:** 「購入設定」セクションで、1点あたりの購入金額を入力します（デフォルトは100円）。
5.  **的中馬番の選択:** 馬券の種類に応じた選択エリアが表示されるので、的中した馬番のボタンをクリックして選択します。
6.  **計算実行:** 「払戻金を計算」ボタンをクリックすると、的中時の払戻金、損益、回収率が表示されます。
7.  **リセット:** 「リセット」ボタンをクリックすると、すべての選択と計算結果がクリアされ、再度今日のレース情報取得から始まります。

## 🤖 スクレイピング機能について

### 取得元
- ✅ **netkeiba.com** から最新の出馬表データと単勝オッズを自動取得します。

### 技術仕様
- **CORSプロキシ**経由でデータ取得（複数のプロキシでフォールバック）
- **DOMParser**でHTML解析
- **単勝オッズ**を自動抽出

### 注意事項
⚠️ スクレイピングを使用する際は以下に注意してください：

- 対象サイトに負荷をかける可能性があります
- 連続して何度もアクセスしないでください
- サイトの構造変更により動作しなくなる可能性があります
- 取得したデータの正確性は保証できません
- **サイトの利用規約を必ず遵守してください**

## 📊 オッズ情報の入手先

### 中央競馬（JRA）
- [JRA公式サイト](https://www.jra.go.jp/)
- [netkeiba](https://www.netkeiba.com/)

### 地方競馬
- [地方競馬全国協会](https://www.keiba.go.jp/)
- [netkeiba 地方競馬](https://nar.netkeiba.com/)

## 💻 技術スタック

- HTML5
- CSS3（レスポンシブデザイン）
- Vanilla JavaScript（フレームワーク不使用）

## 🌐 GitHub Pagesでのデプロイ方法

### 自動デプロイ（推奨）

1. このリポジトリをフォークまたはクローン
2. GitHubリポジトリの Settings > Pages に移動
3. Source で `main` ブランチを選択
4. Save をクリック
5. 数分後、`https://yourusername.github.io/dai-keiba/` でアクセス可能

### ローカルでの動作確認

```bash
# リポジトリをクローン
git clone https://github.com/yourusername/dai-keiba.git
cd dai-keiba

# ローカルサーバーを起動（Python 3の場合）
python -m http.server 8000

# ブラウザで http://localhost:8000 にアクセス
```

## 📝 注意事項

### 計算について
- **払戻金は10円未満切り捨て**で計算されます
- 馬連、馬単、ワイド、三連複、三連単のオッズは、選択した馬の単勝オッズから**簡易計算**しています
- 実際の払戻金は、組み合わせごとのオッズによって異なります
- より正確な計算を行う場合は、実際の組み合わせオッズを入力してください

### 免責事項
- このアプリケーションは**計算ツール**です。実際の馬券購入機能はありません
- オッズ情報の正確性については保証できません
- 馬券の購入は自己責任で行ってください
- ギャンブル依存症にご注意ください

## 🛠️ カスタマイズ

### 色やデザインの変更

`style.css` の ":root" セクションで色を変更できます：

```css
:root {
    --primary-color: #1e90ff;     /* メインカラー */
    --secondary-color: #ffab00;   /* セカンダリカラー */
    --accent-color: #ff6b35;      /* アクセントカラー */
    /* ... */
}
```

### 計算ロジックの改善

`script.js` の以下の関数を編集することで、より正確な計算ロジックを実装できます：

- `calculateDoublePayout()` - 馬連、馬単、ワイドの計算
- `calculateTriplePayout()` - 三連複、三連単の計算

## 📚 参考資料

### 競馬データ取得に関する調査結果

調査の結果、以下のことがわかりました：

#### スクレイピングの課題
- [netkeiba](https://www.netkeiba.com/) は現在スクレイピングが禁止されている可能性があります。
- JRAサイトは可能だが、GitHub Pagesは静的サイトなのでサーバーサイド処理ができない。
- CORS問題により、クライアントサイドから直接APIアクセスは困難。

#### 利用可能なAPI
- [JRA-VAN DataLab](https://jra-van.jp/nx/) (有料、月額2,090円)
- 公式の無料JSON APIは存在しない。

### 参考リンク
- [JRA 払戻計算式](https://jra.jp/faq/pop03/1_17.html)
- [競馬データスクレイピングに関する記事](https://www.octoparse.jp/blog/how-to-collect-horse-racing-information)

## 🤝 コントリビューション

プルリクエストを歓迎します！大きな変更の場合は、まずissueを開いて変更内容を議論してください。

## 📄 ライセンス

MIT License

## 👤 作成者

Created with Claude Code

---

**⚠️ ギャンブルは計画的に。20歳未満の方の馬券購入は法律で禁止されています。**